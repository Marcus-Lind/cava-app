<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cava Macro Calculator</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 10px;
            display: flex;
            flex-direction: column;
            background-color: #f4f7f4;
            color: #333;
            min-height: 100vh;
        }
        header {
            text-align: center;
            margin-bottom: 15px;
        }
        header h1 {
            color: #2e7d32;
            font-size: clamp(1.5em, 5vw, 2.5em);
            margin: 0;
        }
        header p {
            color: #555;
            font-size: clamp(0.8em, 2.5vw, 0.9em);
            margin: 5px 0;
        }
        .content {
            display: flex;
            flex-direction: row;
            flex: 1;
        }
        .left-panel {
            flex: 2;
            padding-right: 15px;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            grid-auto-rows: minmax(150px, auto); /* Ensures rows fill space */
            gap: 15px;
        }
        .category {
            margin-bottom: 0;
        }
        #greens-grains { grid-column: 1 / 2; grid-row: 1 / 2; }
        #toppings { grid-column: 2 / 3; grid-row: 1 / 2; }
        #mains { grid-column: 1 / 2; grid-row: 2 / 3; }
        #dips-spreads { grid-column: 2 / 3; grid-row: 2 / 3; }
        #dressings { grid-column: 1 / 3; grid-row: 3 / 4; }
        .category h2 {
            color: #388e3c;
            font-size: clamp(1.2em, 3.5vw, 1.5em);
            margin-bottom: 8px;
        }
        .item-button {
            background-color: #ffffff;
            border: 1px solid #81c784;
            padding: clamp(6px, 1.5vw, 8px) clamp(8px, 2vw, 12px);
            margin: 4px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            border-radius: 6px;
            transition: background-color 0.3s;
            color: #2e7d32;
            font-size: clamp(0.85em, 2.5vw, 1em);
            /* Removed touch-action: manipulation from here */
        }
        .item-button:hover {
            background-color: #e8f5e9;
        }
        .item-name {
            flex-grow: 1;
            margin-right: clamp(6px, 1.5vw, 8px);
        }
        .count {
            position: absolute;
            top: -6px;
            right: -6px;
            background-color: #ff7043;
            color: white;
            border-radius: 50%;
            width: clamp(16px, 4vw, 20px);
            height: clamp(16px, 4vw, 20px);
            text-align: center;
            font-size: clamp(10px, 2.5vw, 12px);
            line-height: clamp(16px, 4vw, 20px);
            display: none;
        }
        .quantity-controls {
            display: flex;
            gap: clamp(3px, 1vw, 4px);
            touch-action: manipulation; /* Applied here instead */
        }
        .quantity-btn {
            background-color: #388e3c;
            color: white;
            border: none;
            width: clamp(16px, 4vw, 18px);
            height: clamp(16px, 4vw, 18px);
            border-radius: 50%;
            font-size: clamp(10px, 2.5vw, 12px);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.3s;
            /* Removed touch-action: manipulation from here since parent has it */
        }
        .quantity-btn:hover {
            background-color: #2e7d32;
        }
        .quantity-btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .right-panel {
            flex: 1;
            border: 1px solid #d4e4d4;
            padding: clamp(10px, 2.5vw, 15px);
            background-color: #ffffff;
            height: 300px; /* Increased by 50% from ~200px */
            position: sticky;
            top: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            border-radius: 8px;
            overflow-y: auto;
        }
        #nutrition-summary {
            margin-top: clamp(15px, 3vw, 20px);
            padding-top: clamp(10px, 2.5vw, 15px);
            border-top: 1px solid #d4e4d4;
        }
        #nutrition-summary h3 {
            color: #388e3c;
            font-size: clamp(1.1em, 3vw, 1.3em);
            margin-bottom: 8px;
        }
        #nutrition-summary p {
            font-size: clamp(0.85em, 2.5vw, 1em);
            margin: 5px 0;
        }
        #order-list ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        #order-list li {
            margin: clamp(6px, 1.5vw, 8px) 0;
            display: flex;
            justify-content: space-between;
            font-size: clamp(0.8em, 2.2vw, 0.9em);
            color: #555;
        }
        #order-list li span {
            color: #2e7d32;
        }
        .right-panel h2 {
            color: #388e3c;
            font-size: clamp(1.2em, 3.5vw, 1.5em);
            margin-bottom: clamp(10px, 2.5vw, 15px);
        }
        .tooltip {
            position: fixed;
            background: #ffffff;
            border: 1px solid #81c784;
            padding: clamp(6px, 1.5vw, 8px);
            display: none;
            z-index: 10;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            color: #2e7d32;
            font-size: clamp(0.8em, 2.2vw, 0.9em);
        }
        footer {
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: center;
            gap: clamp(15px, 3vw, 20px);
            padding: clamp(15px, 3vw, 20px) 0;
            color: #555;
            font-size: clamp(0.7em, 2vw, 0.8em);
            margin-top: clamp(15px, 3vw, 20px);
        }
        .coffee-button {
            background-color: #388e3c;
            color: white;
            border: none;
            padding: clamp(6px, 1.5vw, 8px) clamp(12px, 2.5vw, 16px);
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s;
            display: flex;
            align-items: center;
            gap: clamp(4px, 1vw, 6px);
            font-size: clamp(0.85em, 2.5vw, 1em);
        }
        .coffee-button:hover {
            background-color: #2e7d32;
        }
        .coffee-icon {
            width: clamp(14px, 3.5vw, 16px);
            height: clamp(14px, 3.5vw, 16px);
        }
        @media (max-width: 768px) {
            body {
                padding: 8px;
            }
            .content {
                flex-direction: column;
            }
            .left-panel, .right-panel {
                flex: none;
                width: 100%;
                padding-right: 0;
            }
            .left-panel {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto auto auto auto;
                gap: 10px;
            }
            #greens-grains, #toppings, #mains, #dips-spreads, #dressings {
                grid-column: 1 / 2;
                grid-row: auto;
            }
            .right-panel {
                position: static; /* Reverts to natural flow */
                margin-top: 15px;
                height: auto; /* Adjusts to content */
                max-height: 50vh; /* Limits height with scrolling */
            }
            footer {
                flex-direction: column;
                gap: 10px;
                padding: 15px 0;
            }
        }
        @media (max-width: 480px) {
            header h1 {
                font-size: clamp(1.2em, 4vw, 1.8em);
            }
            header p {
                font-size: clamp(0.7em, 2vw, 0.8em);
            }
            .category h2 {
                font-size: clamp(1em, 3vw, 1.2em);
            }
            .item-button {
                padding: 5px 8px;
                font-size: clamp(0.75em, 2vw, 0.85em);
            }
            .quantity-btn {
                width: 16px;
                height: 16px;
                font-size: 10px;
            }
            .count {
                width: 16px;
                height: 16px;
                font-size: 10px;
                line-height: 16px;
                top: -5px;
                right: -5px;
            }
            .right-panel {
                max-height: 40vh;
            }
            .right-panel h2 {
                font-size: clamp(1em, 3vw, 1.2em);
            }
            #nutrition-summary h3 {
                font-size: clamp(0.9em, 2.5vw, 1.1em);
            }
            footer {
                padding: 10px 0;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>Cava Macro Calculator</h1>
        <p>This quick calculator is aimed to generate accurate* macros based on the Nutritional Information provided by Cava Group, Inc.</p>
        <p>*all information shared by this site is made based on calculations of the provided material. Please note that serving sizes may vary based on alternative factors.</p>
    </header>

    <div class="content">
        <div class="left-panel">
            <div class="category" id="greens-grains">
                <h2>Greens + Grains</h2>
            </div>

            <div class="category" id="toppings">
                <h2>Toppings</h2>
            </div>

            <div class="category" id="mains">
                <h2>Mains</h2>
            </div>

            <div class="category" id="dips-spreads">
                <h2>Dips & Spreads</h2>
            </div>

            <div class="category" id="dressings">
                <h2>Dressings</h2>
            </div>
        </div>

        <div class="right-panel">
            <h2>Your Bowl</h2>
            <div id="order-list">
                <ul></ul>
            </div>
            <div id="nutrition-summary">
                <h3>Totals</h3>
                <p>Calories: <span id="total-calories">0</span></p>
                <p>Carbohydrates (g): <span id="total-carbs">0</span></p>
                <p>Total Fat (g): <span id="total-fat">0</span></p>
                <p>Protein (g): <span id="total-protein">0</span></p>
            </div>
        </div>
    </div>

    <footer>
        <p>This site is not associated with or endorsed by Cava Group, Inc or any related entities.</p>
        <p>Please "Buy me a Coffee" if you feel this site provided value to you. If you work for CAVA, please add this functionality to your website!</p>
        <button class="coffee-button" onclick="window.open('https://www.buymeacoffee.com/mlindblo', '_blank')">
            <svg class="coffee-icon" viewBox="0 0 24 24" fill="white">
                <path d="M5 2h14a2 2 0 0 1 2 2v12a2 2 0 0 1-1.6 1.96L18 22H6l-1.6-4.04A2 2 0 0 1 3 16V4a2 2 0 0 1 2-2zm2 14h10v2H7v-2zm11-2H6V4h12v10z"/>
            </svg>
            Buy Me a Coffee
        </button>
    </footer>

    <div id="tooltip" class="tooltip"></div>

    <script>
        // Nutritional data from the provided PDF
        const nutritionData = {
            "Greens + Grains": {
                "Brown Rice": { "calories": 310, "carbohydrates_g": 48, "total_fat_g": 10, "protein_g": 7 },
                "Saffron Basmati Rice": { "calories": 290, "carbohydrates_g": 54, "total_fat_g": 7, "protein_g": 5 },
                "Black Lentils": { "calories": 270, "carbohydrates_g": 37, "total_fat_g": 7, "protein_g": 18 },
                "SuperGreens": { "calories": 40, "carbohydrates_g": 8, "total_fat_g": 0.5, "protein_g": 3 },
                "Arugula": { "calories": 20, "carbohydrates_g": 3, "total_fat_g": 0.5, "protein_g": 2 },
                "Baby Spinach": { "calories": 20, "carbohydrates_g": 3, "total_fat_g": 0, "protein_g": 3 },
                "Romaine": { "calories": 20, "carbohydrates_g": 4, "total_fat_g": 0, "protein_g": 1 },
                "SplendidGreens®": { "calories": 20, "carbohydrates_g": 4, "total_fat_g": 0, "protein_g": 1 }
            },
            "Toppings": {
                "Shredded Romaine": { "calories": 5, "carbohydrates_g": 1, "total_fat_g": 0, "protein_g": 0 },
                "Pita Crisps": { "calories": 70, "carbohydrates_g": 6, "total_fat_g": 11, "protein_g": 1 },
                "Cabbage Slaw": { "calories": 35, "carbohydrates_g": 2, "total_fat_g": 3, "protein_g": 0 },
                "Tomato + Onion": { "calories": 20, "carbohydrates_g": 2, "total_fat_g": 1.5, "protein_g": 0 },
                "Persian Cucumber": { "calories": 15, "carbohydrates_g": 1, "total_fat_g": 1, "protein_g": 0 },
                "Tomato + Cucumber": { "calories": 5, "carbohydrates_g": 1, "total_fat_g": 0, "protein_g": 0 },
                "Kalamata Olives": { "calories": 35, "carbohydrates_g": 2, "total_fat_g": 3, "protein_g": 0 },
                "Fiery Broccoli": { "calories": 35, "carbohydrates_g": 2, "total_fat_g": 2.5, "protein_g": 1 },
                "Pickled Onions": { "calories": 20, "carbohydrates_g": 5, "total_fat_g": 0, "protein_g": 0 },
                "Salt-Brined Pickles": { "calories": 5, "carbohydrates_g": 0, "total_fat_g": 0, "protein_g": 0 },
                "Crumbled Feta": { "calories": 35, "carbohydrates_g": 0, "total_fat_g": 2.5, "protein_g": 3 },
                "Fire-Roasted Corn": { "calories": 45, "carbohydrates_g": 5, "total_fat_g": 2.5, "protein_g": 1 },
                "Avocado": { "calories": 110, "carbohydrates_g": 7, "total_fat_g": 11, "protein_g": 2 }
            },
            "Mains": {
                "Braised Lamb": { "calories": 210, "carbohydrates_g": 2, "total_fat_g": 12, "protein_g": 24 },
                "Grilled Chicken": { "calories": 250, "carbohydrates_g": 3, "total_fat_g": 13, "protein_g": 28 },
                "Falafel": { "calories": 350, "carbohydrates_g": 24, "total_fat_g": 26, "protein_g": 6 },
                "Grilled Steak": { "calories": 170, "carbohydrates_g": 1, "total_fat_g": 9, "protein_g": 23 },
                "Harissa Honey Chicken": { "calories": 260, "carbohydrates_g": 7, "total_fat_g": 14, "protein_g": 26 },
                "Roasted Vegetables": { "calories": 100, "carbohydrates_g": 14, "total_fat_g": 4.5, "protein_g": 3 },
                "Spicy Lamb Meatballs": { "calories": 300, "carbohydrates_g": 3, "total_fat_g": 21, "protein_g": 24 },
                "Chicken Shawarma": { "calories": 100, "carbohydrates_g": 1, "total_fat_g": 3, "protein_g": 16 }
            },
            "Dips & Spreads": {
                "Tzatziki": { "calories": 35, "carbohydrates_g": 1, "total_fat_g": 2.5, "protein_g": 2 },
                "Hummus": { "calories": 45, "carbohydrates_g": 4, "total_fat_g": 2.5, "protein_g": 2 },
                "Roasted Eggplant": { "calories": 50, "carbohydrates_g": 2, "total_fat_g": 5, "protein_g": 0 },
                "Crazy Feta®": { "calories": 70, "carbohydrates_g": 1, "total_fat_g": 6, "protein_g": 4 },
                "Harissa": { "calories": 70, "carbohydrates_g": 5, "total_fat_g": 6, "protein_g": 1 },
                "Red Pepper Hummus": { "calories": 40, "carbohydrates_g": 5, "total_fat_g": 1.5, "protein_g": 2 }
            },
            "Dressings": {
                "Balsamic Date Vinaigrette": { "calories": 60, "carbohydrates_g": 7, "total_fat_g": 4, "protein_g": 0 },
                "Yogurt Dill": { "calories": 30, "carbohydrates_g": 1, "total_fat_g": 2, "protein_g": 2 },
                "Lemon-Herb Tahini": { "calories": 70, "carbohydrates_g": 4, "total_fat_g": 6, "protein_g": 2 },
                "Tahini Caesar": { "calories": 90, "carbohydrates_g": 3, "total_fat_g": 8, "protein_g": 2 },
                "Greek Vinaigrette": { "calories": 130, "carbohydrates_g": 1, "total_fat_g": 14, "protein_g": 0 },
                "Skhug": { "calories": 80, "carbohydrates_g": 1, "total_fat_g": 9, "protein_g": 0 },
                "Hot Harissa Vinaigrette": { "calories": 70, "carbohydrates_g": 1, "total_fat_g": 7, "protein_g": 0 },
                "Garlic Dressing": { "calories": 180, "carbohydrates_g": 0, "total_fat_g": 20, "protein_g": 0 }
            }
        };

        // Track selected items with quantities
        let order = {};

        // Function to update totals and order list
        function updateUI() {
            const totals = { calories: 0, carbohydrates_g: 0, total_fat_g: 0, protein_g: 0 };
            const orderList = document.querySelector('#order-list ul');
            orderList.innerHTML = '';

            for (const [itemName, { item, count }] of Object.entries(order)) {
                const itemTotals = {
                    calories: item.calories * count,
                    carbohydrates_g: item.carbohydrates_g * count,
                    total_fat_g: item.total_fat_g * count,
                    protein_g: item.protein_g * count
                };

                totals.calories += itemTotals.calories;
                totals.carbohydrates_g += itemTotals.carbohydrates_g;
                totals.total_fat_g += itemTotals.total_fat_g;
                totals.protein_g += itemTotals.protein_g;

                const li = document.createElement('li');
                li.innerHTML = `${itemName} (x${count}) <span>${itemTotals.calories} cal, ${itemTotals.carbohydrates_g}g carbs, ${itemTotals.total_fat_g}g fat, ${itemTotals.protein_g}g protein</span>`;
                orderList.appendChild(li);
            }

            document.getElementById('total-calories').textContent = totals.calories;
            document.getElementById('total-carbs').textContent = totals.carbohydrates_g;
            document.getElementById('total-fat').textContent = totals.total_fat_g;
            document.getElementById('total-protein').textContent = totals.protein_g;
        }

        // Function to populate buttons
        function populateCategory(categoryId, categoryName) {
            const container = document.getElementById(categoryId);
            const items = nutritionData[categoryName];
            const isMobileView = window.matchMedia("(max-width: 768px)").matches;

            for (const itemName in items) {
                const button = document.createElement('div');
                button.className = 'item-button';
                button.dataset.item = JSON.stringify(items[itemName]);
                button.dataset.name = itemName;

                const nameSpan = document.createElement('span');
                nameSpan.className = 'item-name';
                nameSpan.textContent = itemName;
                button.appendChild(nameSpan);

                const countSpan = document.createElement('span');
                countSpan.className = 'count';
                countSpan.textContent = '0';
                button.appendChild(countSpan);

                const controlsDiv = document.createElement('div');
                controlsDiv.className = 'quantity-controls';

                const minusBtn = document.createElement('button');
                minusBtn.className = 'quantity-btn';
                minusBtn.textContent = '−';
                minusBtn.disabled = true;
                controlsDiv.appendChild(minusBtn);

                const plusBtn = document.createElement('button');
                plusBtn.className = 'quantity-btn';
                plusBtn.textContent = '+';
                controlsDiv.appendChild(plusBtn);

                button.appendChild(controlsDiv);

                // Add functionality for both click and touch
                plusBtn.addEventListener('click', handleAdd);
                plusBtn.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    handleAdd(e);
                });
                minusBtn.addEventListener('click', handleRemove);
                minusBtn.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    handleRemove(e);
                });

                function handleAdd(e) {
                    if (!order[itemName]) {
                        order[itemName] = { item: items[itemName], count: 0 };
                    }
                    order[itemName].count++;
                    countSpan.textContent = order[itemName].count;
                    countSpan.style.display = 'block';
                    minusBtn.disabled = false;
                    updateUI();
                }

                function handleRemove(e) {
                    if (order[itemName] && order[itemName].count > 0) {
                        order[itemName].count--;
                        countSpan.textContent = order[itemName].count;
                        if (order[itemName].count === 0) {
                            delete order[itemName];
                            countSpan.style.display = 'none';
                            minusBtn.disabled = true;
                        }
                        updateUI();
                    }
                }

                // Tooltip for desktop only (when not in mobile view)
                if (!isMobileView) {
                    button.addEventListener('mouseover', (e) => showTooltip(e, items[itemName]));
                    button.addEventListener('mouseout', hideTooltip);
                }

                container.appendChild(button);
            }
        }

        function showTooltip(e, data) {
            const tooltip = document.getElementById('tooltip');
            tooltip.innerHTML = `
                Calories: ${data.calories}<br>
                Carbs: ${data.carbohydrates_g}g<br>
                Total Fat: ${data.total_fat_g}g<br>
                Protein: ${data.protein_g}g
            `;
            tooltip.style.display = 'block';
            const touch = e.touches ? e.touches[0] : e;
            tooltip.style.left = `${touch.pageX + 10}px`;
            tooltip.style.top = `${touch.pageY + 10}px`;
        }

        function hideTooltip() {
            document.getElementById('tooltip').style.display = 'none';
        }

        // Populate all categories
        populateCategory('greens-grains', 'Greens + Grains');
        populateCategory('toppings', 'Toppings');
        populateCategory('mains', 'Mains');
        populateCategory('dips-spreads', 'Dips & Spreads');
        populateCategory('dressings', 'Dressings');
    </script>
</body>
</html>